##This src file is a modified copy from https://github.com/sillsill777/Diffusion/tree/master/src